"0",""
"0","# make one normal distribution"
"0","mu    <- 0"
"0","sigma <- 1"
"0","nSd   <- 30"
"0","xLims <- c(mu-nSd*sigma, mu+nSd*sigma)"
"0","X     <- seq(xLims[1], xLims[2], length.out=98)"
"0",""
"0","# the last 2 points are reserved for (mu, dnorm(mu)) and (mu, 0)"
"0","X[length(X)+1] <- mu             # for point (mu, dnorm(mu))"
"0","X[length(X)+1] <- mu             # for point (mu, 0)"
"0","Y <- dnorm(X, mu, sigma)         # y coordinates"
"0",""
"0","#X <- seq(10, 20, length.out = 100)"
"0","#Y <- dnorm(X, mean =15)"
"0",""
"0","# scale distribution to different width and height"
"0","nxW <- 100"
"0","nyW <- 10"
"0","X   <- (X / diff(range(X))) * nxW"
"0","Y   <- (Y / diff(range(Y))) * nyW"
"0","Y[length(Y)] <- 0                # point (mu, 0)"
"0",""
"0","# rotate normal distribution 90Â° clockwise"
"0","XY  <- cbind(X, Y)"
"0","ang <- pi/2"
"0","R   <- matrix(c(cos(ang), sin(ang), -sin(ang), cos(ang)), nrow=2)"
"0","XYr <- XY %*% R"
"0",""
"0","# chose a couple of x-coordinates to place rotated normal distributions"
"0","# ptsX <- x[round(seq(1, length(x), length.out=6))]"
"0","# ptsX <- ptsX[-c(1, length(ptsX))]"
"0","# ptsY <- b*ptsX + a"
"0","# pts  <- cbind(ptsX, ptsY)"
"0",""
"0","pts <- data.frame(ptsX = seq(10, 100, by = 20), "
"0","                  ptsY = rep(0, 20))"
"0",""
"0","pts <- as.matrix(pts)"
"0","ptsX <- pts[, 1]"
"0","ptsY <- pts[, 2]"
"0",""
"0","# move normal distibutions to chosen (x, y)-coords as center and draw them"
"0","nr   <- nrow(XY)"
"0","XYrt <- vector(""list"", length(ptsX))"
"0","for (i in seq(along=ptsX)) {"
"0","  "
"0","  XYrt[[i]] <- sweep(XYr, 2, pts[i, ], ""+"")"
"0","  "
"0","  polygon(XYrt[[i]][-c(nr, nr-1) , 1], XYrt[[i]][-c(nr, nr-1) , 2], border=NA, col=rgb(0.7, 0.7, 0.7, 0.2))"
"0","  "
"0","  #lines(XYrt[[i]][-c(nr, nr-1) , 1], XYrt[[i]][-c(nr, nr-1) , 2], col=""red"", lwd=3)"
"0","  "
"0","  segments(XYrt[[i]][nr, 1], XYrt[[i]][nr, 2], XYrt[[i]][nr-1, 1], XYrt[[i]][nr-1, 2], col=""black"", lwd = 2, lty = 2)"
"0","}"
